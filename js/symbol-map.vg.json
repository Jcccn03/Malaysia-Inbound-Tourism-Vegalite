{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "projection": {
    "type": "mercator",
    "center": [
      110,
      4.0
    ],
    "scale": 3000
  },
  "width": 1290,
  "height": 600,
  "params": [
    {
      "name": "year_selection",
      "value": 2018,
      "bind": {
        "input": "select",
        "options": [
          2018,
          2019,
          2020,
          2021,
          2022,
          2023
        ],
        "labels": [
          "2018",
          "2019",
          "2020",
          "2021",
          "2022",
          "2023"
        ],
        "name": "Select Year:  ",
        "element": "#filter-box"
      }
    }
  ],
  "layer": [
    {
      "data": {
        "graticule": {
          "extent": [
            [
              90,
              -10
            ],
            [
              125,
              10
            ]
          ],
          "step": [
            5,
            5
          ]
        }
      },
      "mark": {
        "type": "geoshape",
        "stroke": "lightgray"
      }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/Jcccn03/Malaysia-Inbound-Tourism-Vegalite/master/js/mys_map.json",
        "format": {
          "type": "topojson",
          "feature": "my"
        }
      },
      "mark": {
        "type": "geoshape",
        "fill": "lightgray",
        "stroke": "white"
      }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/Jcccn03/Malaysia-Inbound-Tourism-Vegalite/master/data/parks.csv"
      },
      "transform": [
        {
          "filter": "datum.Year == year_selection"
        },
        {
          "window": [
            {
              "op": "rank",
              "as": "rank"
            }
          ],
          "sort": [
            {
              "field": "Visitors",
              "order": "descending"
            }
          ]
        }
      ],
      "layer": [
        {
          "mark": {
            "type": "circle",
            "opacity": 0.5,
            "fill": "green"
          },
          "encoding": {
            "longitude": {
              "field": "Longitude",
              "type": "quantitative"
            },
            "latitude": {
              "field": "Latitude",
              "type": "quantitative"
            },
            "size": {
              "field": "Visitors",
              "type": "quantitative",
              "title": "Tourists",
              "scale": {
                "range": [
                  30,
                  2000
                ]
              },
              "legend": {
                "orient": "none",
                "legendX": 1170,
                "legendY": 20
              }
            },
            "tooltip": [
              {
                "field": "Park_Name",
                "title": "Park"
              },
              {
                "field": "Visitors",
                "title": "Tourist count",
                "format": ","
              },
              {
                "field": "Year",
                "title": "Year"
              }
            ]
          }
        },
        {
          "transform": [
            {
              "filter": "datum.Rank <= 3"
            }
          ],
          "mark": {
            "type": "text",
            "dy": {
              "expr": "datum.Rank * 10 - 20"
            },
            "dx": {
              "expr": "datum.Rank * 12 - 20"
            },
            "fontWeight": "bold",
            "fontSize": 12,
            "align": "center"
          },
          "encoding": {
            "longitude": {
              "field": "Longitude",
              "type": "quantitative"
            },
            "latitude": {
              "field": "Latitude",
              "type": "quantitative"
            },
            "text": {
              "field": "Park_Name"
            }
          }
        }
      ]
    }
  ]
}